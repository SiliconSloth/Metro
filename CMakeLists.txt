cmake_minimum_required (VERSION 2.6)
set (CMAKE_CXX_STANDARD 17)
include(CheckCXXSymbolExists)
project (Metro)

set(libgitInclude $ENV{LIBGIT_INCLUDE_DIR})
IF (DEFINED libgitInclude)
    include_directories("${libgitInclude}")
ENDIF()
set(libgitBuild $ENV{LIBGIT_BUILD_DIR})

include_directories("include")
add_executable(metro src/main.cpp src/gitwrapper/strarray.cpp include/gitwrapper/strarray.h)
add_executable(test src/test.cpp)

IF (WIN32)
    IF (DEFINED libgitBuild)
        set_target_properties(git2 PROPERTIES IMPORTED_LOCATION "${libgitBuild}/git2.lib")
    ENDIF()
    target_link_libraries(metro git2 winhttp Rpcrt4 crypt32)
    target_link_libraries(test git2 winhttp Rpcrt4 crypt32)
ENDIF()
IF (UNIX)
    IF (DEFINED libgitBuild)
        set_target_properties(git2 PROPERTIES IMPORTED_LOCATION "${libgitBuild}/libgit2.a")
    ENDIF()
    target_link_libraries(metro git2 pthread z ssl crypto)
    target_link_libraries(test git2 pthread z ssl crypto)
ENDIF()